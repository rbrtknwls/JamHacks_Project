<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Calculator</title>
    <script src="http://www.chartjs.org/dist/2.7.2/Chart.bundle.js"></script>
    <script src="http://www.chartjs.org/samples/latest/utils.js"></script>
    <script src="js/html5shiv.js"></script>
    <script src="js/jquery.min.js"></script>
    <script src="js/skel.min.js"></script>
    <script src="js/skel-layers.min.js"></script>
    <script src="js/init.js"></script>
    <noscript>
        <link rel="stylesheet" href="css/skel.css"/>
        <link rel="stylesheet" href="css/style.css"/>
        <link rel="stylesheet" href="css/style-xlarge.css"/>
    </noscript>
</head>
<body id="top">

<!--Header-->
<header id="header" class="skel-layers-fixed">
    <h1><a href="#"></a></h1>
    <nav id="nav">
        <ul>
            <li><a href="index.html">Home</a></li>
            <li><a href="learnmore.html">Research</a></li>
        </ul>
    </nav>
</header>

<section id="one" class="wrapper style1">
    <header class="major">
        <h2>Optimal Mark Calculator</h2>
    </header>
    <div class="container">
        <section class="special box">
            <div class="row">
                <div class="6u">
                    <h3>Amount of Time</h3>
                    <p><input id="time" type="number" value="1"></p>
                </div>
                <div class="6u">
                    <h3>Sleep Gotten Night before</h3>
                    <input id="specificStudypre" type="number" value="950">
                </div>
                <div class="12u">
                    <button onclick="toggleLoading()" class="button">Calculate</button>
                    <script>
                        function sleep(ms) {
                            return new Promise(resolve => setTimeout(resolve, ms));
                        }

                        async function toggleLoading() {
                            document.getElementById("loadingLMAO").src = "images/loading.gif"
                            document.getElementById("msgAfterLoad").innerText = ""
                            await sleep(1000);
                            document.getElementById("loadingLMAO").src = "images/white.png"
                            min = document.getElementById("time").value;
                            sleepamt = document.getElementById("specificStudypre").value;
                            if (sleepamt < 570){
                                if (min >= 1380){
                                    document.getElementById("msgAfterLoad").innerText = "Studying = " + (min*0.67) + " min  Sleeping = " + (min * 0.33) + " min"
                                }else if (min >= 750){
                                    document.getElementById("msgAfterLoad").innerText = "Studying = " + (min*0.64) + " min  Sleeping = " + (min * 0.36) + " min"
                                }else if (min >= 450){
                                    document.getElementById("msgAfterLoad").innerText = "Studying = " + (min*0.53) + " min  Sleeping = " + (min * 0.47) + " min"
                                }else if (min >= 200){
                                    document.getElementById("msgAfterLoad").innerText = "Studying = " + (min*0.37) + " min  Sleeping = " + (min * 0.63) + " min"
                                }else{
                                    document.getElementById("msgAfterLoad").innerText = "Studying = " + (min*0.23) + " min  Sleeping = " + (min*77) + " min"
                                }
                            }else{
                                if (min >= 1380){
                                    document.getElementById("msgAfterLoad").innerText = "Studying = " + (min*0.27) + " min  Sleeping = " + (min * 0.73) + " min"
                                }else if (min >= 750){
                                    document.getElementById("msgAfterLoad").innerText = "Studying = " + (min*0.64) + " min  Sleeping = " + (min * 0.36) + " min"
                                }else if (min >= 450){
                                    document.getElementById("msgAfterLoad").innerText = "Studying = " + (min*0.73) + " min  Sleeping = " + (min * 0.27) + " min"
                                }else if (min >= 200){
                                    document.getElementById("msgAfterLoad").innerText = "Studying = " + (min*0.82) + " min  Sleeping = " + (min * 0.18) + " min"
                                }else{
                                    document.getElementById("msgAfterLoad").innerText = "Studying = " + (min) + " min  Sleeping = " + (0) + " min"
                                }


                            }
    
                            
                        }
                    </script>
                    <div class="row">
                        <div class="12u">
                            <br>
                            <center><img src="images/white.png" id="loadingLMAO"></center>
                            <center><h2 id="msgAfterLoad"></h2></center>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <div class="container">
        <section class="special box">
            <h2>Sample Score Graph</h2>
            <div class="row">
                <div class="4u">
                    <h1></h1>
                </div>
                <div class="4u">
                    <h3>Difficulty of Test</h3>
                    <p><input type="range" min="1" max="100" value="50" class="slider" id="difficulty"></p>
                </div>
                <div class="4u">
                    <h1></h1>
                </div>
            </div>
            <div class="12u">
                <canvas id="StudyingChart"></canvas>
            </div>
            <div class="12u"><h1></h1></div>
            <button onclick="runner()" class="button">Refresh Graph</button>
        </section>
    </div>

</section>


<!-- JS -->
<script>
    var ctx = document.getElementById("StudyingChart").getContext('2d');

    function pf(st) {
        return (pc(st) - (100 - ps(st)))
    }

    function ps(st) {
        return (100 - ((st * st) + 3.2) / 90783)
    }

    function pc(st) {
        // 1.67705098312 * √x + 55
        return ((2 * Math.sqrt(st)) + 65)
    }

    totalMins = 720

    timest = []
    timesl = []
    timef = []

    for (i = -1; i < totalMins; i += 60) {
        timest.push(i + 1)
        timesl.push(i + 1)
        timef.push(i + 1)
    }


    dataPrest = []
    dataPresl = []
    dataPref = []
    for (i = 0; i < timest.length; i++) {
        if (pc(timest[i]) > 100) dataPrest.push(100);
        else dataPrest.push(pc(timest[i]));
    }

    for (i = 0; i < timesl.length; i++) {
        if (ps(timesl[i]) < 0) dataPresl.push(0);
        else dataPresl.push(ps(timesl[i]));
    }

    for (i = 0; i < timef.length; i++) {
        if (pf(timef[i]) > 100) dataPref.push(100);
        else dataPref.push(pf(timef[i]));
        console.log(pf(timef[i]));
    }
    timeMinListst = timest
    timeMinListsl = timesl
    timeMinListf = timef
    for (i = 0; i < timeMinListst.length; i++) {
        timeMinListst[i] = timeMinListst[i] / 60
        timeMinListsl[i] = timeMinListsl[i] / 60
        timeMinListf[i] = timeMinListf[i] / 60
    }

    var StudyingChart = new Chart(ctx, {
        type: 'line',
        data: {
            labels: timeMinListst, //Time studying
            datasets: [{
                label: 'Studying Coefficient',
                data: dataPrest, //Studying
                backgroundColor: [
                    'rgba(255, 0, 0, 0.2)'
                ],
                borderColor: [
                    'rgb(255, 0, 0)'
                ],
                borderWidth: 1
            }, {
                label: 'Amount of Sleep',
                data: dataPresl, //Sleep
                backgroundColor: [
                    'rgba(0, 0, 255, 0.2)'
                ],
                borderColor: [
                    'rgb(0, 0, 255)'
                ],
                borderWidth: 1
            }, {
                label: 'Time studying',
                data: dataPref, //Final
                backgroundColor: [
                    'rgba(255, 255, 0, 0.2)'
                ],
                borderColor: [
                    'rgb(255, 255, 0)'
                ],
                borderWidth: 1
            }]
        }
    });

    function runner() {
        var ctx = document.getElementById("StudyingChart").getContext('2d');
        function pf(st) {
            return (pc(st) - (100 - ps(st)))
        }

        function ps(st) {
            return (100 - (((st * st) + 3.2) / 90783))
        }

        function pc(st) {
            // 1.67705098312 * √x + 55
            return (((2 * Math.sqrt(st)) + 65 - (document.getElementById("difficulty").value - 50) / 6))
        }

        totalMins = 720

        timest = []
        timesl = []
        timef = []

        for (i = -1; i < totalMins; i += 60) {
            timest.push(i + 1)
            timesl.push(i + 1)
            timef.push(i + 1)
        }


        dataPrest = []
        dataPresl = []
        dataPref = []
        for (i = 0; i < timest.length; i++) {
            if (pc(timest[i]) > 100) dataPrest.push(100);
            else dataPrest.push(pc(timest[i]));
        }

        for (i = 0; i < timesl.length; i++) {
            if (ps(timesl[i]) < 0) dataPresl.push(0);
            else dataPresl.push(ps(timesl[i]));
        }

        for (i = 0; i < timef.length; i++) {
            if (pf(timef[i]) > 100) dataPref.push(100);
            else dataPref.push(pf(timef[i]));
            console.log(pf(timef[i]));
        }
        timeMinListst = timest
        timeMinListsl = timesl
        timeMinListf = timef
        for (i = 0; i < timeMinListst.length; i++) {
            timeMinListst[i] = timeMinListst[i] / 60
            timeMinListsl[i] = timeMinListsl[i] / 60
            timeMinListf[i] = timeMinListf[i] / 60
        }

        var StudyingChart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: timeMinListst, //Time studying
                datasets: [{
                    label: 'Studying Coefficient',
                    data: dataPrest, //Studying
                    backgroundColor: [
                        'rgba(255, 0, 0, 0.2)'
                    ],
                    borderColor: [
                        'rgb(255, 0, 0)'
                    ],
                    borderWidth: 1
                }, {
                    label: 'Amount of Sleep',
                    data: dataPresl, //Sleep
                    backgroundColor: [
                        'rgba(0, 0, 255, 0.2)'
                    ],
                    borderColor: [
                        'rgb(0, 0, 255)'
                    ],
                    borderWidth: 1
                }, {
                    label: 'Time studying',
                    data: dataPref, //Final
                    backgroundColor: [
                        'rgba(255, 255, 0, 0.2)'
                    ],
                    borderColor: [
                        'rgb(255, 255, 0)'
                    ],
                    borderWidth: 1
                }]
            }
        });
    }

</script>

</body>
</html>